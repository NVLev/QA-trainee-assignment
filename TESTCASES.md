# Тест-кейсы для микросервиса объявлений

## 1. Создание объявления (POST /api/1/item)

### 1.1. Позитивные тесты.  

### TC-1.1.1: Успешное создание объявления
- **Предусловие**: Нет.
- **Шаги**:
  1. Отправить POST-запрос на `/api/1/item` с телом:
     ```json
     {
       "sellerID": 123456,
       "name": "Test Item",
       "price": 1000
     }
     ```
  2. Проверить статус ответа.
  3. Проверить, что в ответе есть поле `status`.
- **Ожидаемый результат**:
  - Статус ответа: `200 OK`.
  - В ответе есть поле `status`.



### TC-1.1.2: Создание объявления с разными `sellerID` в пределах допустимого диапазона
- **Предусловие**: Нет.
- **Шаги**:
  1. Отправить POST-запрос на `/api/1/item` с JSON-телом, где `sellerID` = 111111:
     ```json
     {
       "sellerID": 111111,
       "name": "Item 1",
       "price": 100
     }
     ```
  2. Проверить статус ответа.
  3. Проверить, что в ответе есть поле `id`.
  4. Отправить POST-запрос на `/api/1/item` с JSON-телом, где `sellerID` = 555555:
     ```json
     {
       "sellerID": 555555,
       "name": "Item 2",
       "price": 200
     }
     ```
  5. Проверить статус ответа.
  6. Проверить, что в ответе есть поле `id`.
  7. Отправить POST-запрос на `/api/1/item` с JSON-телом, где `sellerID` = 999999:
     ```json
     {
       "sellerID": 999999,
       "name": "Item 3",
       "price": 300
     }
     ```
  8. Проверить статус ответа.
  9. Проверить, что в ответе есть поле `id`.
  10. Проверить, что в базе данных появились три новые записи с указанными данными.
- **Ожидаемый результат**:
  - Для каждого запроса статус ответа: `201 Created`.
  - В каждом ответе есть поле `id`.
  - В базе данных созданы три новые записи с указанными данными.

### 1.2. Негативные тесты
### TC-1.2.1.1: Попытка создания объявления без обязательных полей - нет sellerID
- **Предусловие**: Нет.
- **Шаги**:
  1. Отправить POST-запрос на `/api/1/item` с телом:
     ```json
     {
       "name": "Test Item",
       "price": 1000
     }
     ```
  2. Проверить статус ответа.
  3. Проверить, что в ответе есть сообщение об ошибке.
- **Ожидаемый результат**:
  - Статус ответа: `400 Bad Request`.
  - В ответе есть сообщение об ошибке.

### TC-1.2.1.2: Попытка создания объявления без обязательных полей - нет поля "name"
- **Предусловие**: Нет.
- **Шаги**:
  1. Отправить POST-запрос на `/api/1/item` с телом:
     ```json
     {
       "sellerID": 111112,
       "price": 100
     }
     ```
  2. Проверить статус ответа.
  3. Проверить, что в ответе есть сообщение об ошибке.
- **Ожидаемый результат**:
  - Статус ответа: `400 Bad Request`.
  - В ответе есть сообщение об ошибке.

### TC-1.2.1.3: Попытка создания объявления без обязательных полей - нет поля "price"
- **Предусловие**: Нет.
- **Шаги**:
  1. Отправить POST-запрос на `/api/1/item` с телом:
     ```json
     {
       "sellerID": 111113,
       "name": "Neg_test Item"
     }
     ```
  2. Проверить статус ответа.
  3. Проверить, что в ответе есть сообщение об ошибке.
- **Ожидаемый результат**:
  - Статус ответа: `400 Bad Request`.
  - В ответе есть сообщение об ошибке.
  - 
### TC-1.2.2: Попытка создания объявления с некорректным типом данных
- **Предусловие**: Нет.
- **Шаги**:
  1. Отправить POST-запрос на `/api/1/item` с телом:
     ```json
     {
       "sellerID": "invalid_id",
       "name": "Test Item",
       "price": 1000
     }
     ```
  2. Проверить статус ответа.
  3. Проверить, что в ответе есть сообщение об ошибке.
- **Ожидаемый результат**:
  - Статус ответа: `400 Bad Request`.
  - В ответе есть сообщение об ошибке.

---

## 2. Получение объявления по идентификатору (GET /api/1/item/{id})

### 2.1. Позитивные тесты

### TC-2.1.1: Успешное получение объявления
- **Предусловие**: Нет (объявление создается в процессе теста).
- **Шаги**:
  1. Создать объявление через POST-запрос:
     ```json
     {
       "sellerID": 789012,
       "name": "Test Item for GET",
       "price": 750
     }
     ```
  2. Проверить, что статус ответа = 200.
  3. Извлечь ID объявления из поля `status` ответа (формат: "Сохранили объявление - <UUID>").
  4. Отправить GET-запрос на `/api/1/item/{id}` с полученным ID.
  5. Проверить статус ответа.
  6. Проверить структуру ответа.
  7. Сравнить данные ответа с исходными данными объявления.

- **Ожидаемый результат**:
  1. Статус ответа при создании: `200 OK`.
  2. Поле `status` содержит ID созданного объявления.
  3. Статус ответа при получении: `200 OK`.
  4. Ответ содержит массив с одним элементом.
  5. Обязательные поля присутствуют:
     - `id` (строка)
     - `sellerId` (число)
     - `name` (строка)
     - `price` (число)
     - `statistics` (объект)
  6. Значения полей совпадают с исходными:
     - `id` соответствует переданному в запросе
     - `name` = "Test Item for GET"
     - `price` = 750
  7. Объект `statistics` содержит поля:
     - `likes` (число)
     - `viewCount` (число)
     - `contacts` (число)

### 2.2. Негативные тесты

### TC-2.2. 1: Попытка получения несуществующего объявления
- **Предусловие**: Объявление с указанным `id` не существует.
- **Шаги**:
  1. Отправить GET-запрос на `/api/1/item/{id}`, где `id` — несуществующий идентификатор.
  2. Проверить статус ответа.
  3. Проверить, что в ответе есть сообщение об ошибке.
- **Ожидаемый результат**:
  - Статус ответа: `404 Not Found`.
  - В ответе есть сообщение об ошибке.


---

## 3. Получение всех объявлений по идентификатору продавца (GET /api/1/{sellerID}/item)

### 3.1. Позитивные тесты

#### TC-3.1.1: Проверка успешного статуса ответа
- **Предусловие**: Создано минимум одно объявление с `sellerID = 789012`.
- **Шаги**:
  1. Отправить GET-запрос на `/api/1/789012/item`.
- **Ожидаемый результат**:
  - Статус ответа: `200 OK`.

---

#### TC-3.1.2: Проверка структуры ответа
- **Предусловие**: Создано минимум одно объявление с `sellerID = 789012`.
- **Шаги**:
  1. Отправить GET-запрос на `/api/1/789012/item`.
  2. Проверить формат ответа.
- **Ожидаемый результат**:
  - Ответ содержит массив объявлений.
  - Каждый элемент массива содержит обязательные поля:
    - `id` (строка)
    - `sellerId` (число)
    - `name` (строка)
    - `price` (число)
    - `statistics` (объект).

---

#### TC-3.1.3: Проверка соответствия sellerID
- **Предусловие**: Создано объявление с `sellerID = 789012`.
- **Шаги**:
  1. Отправить GET-запрос на `/api/1/789012/item`.
  2. Проверить все элементы в ответе.
- **Ожидаемый результат**:
  - Для всех объявлений в списке `sellerId = 789012`.

---

#### TC-3.1.4: Проверка данных созданного объявления
- **Предусловие**: Создано объявление с параметрами:
  ```json
  {
    "sellerID": 789012,
    "name": "UniqueTestItem",
    "price": 999
  }
- **Шаги**:
- Отправить GET-запрос на /api/1/789012/item.

- Найти объявление с name = "UniqueTestItem".

- **Ожидаемый результат**:

- Найдено хотя бы одно объявление.

- Поля объявления соответствуют созданным:

- `name` = "UniqueTestItem"

- `price` = 999.

### TC-3.1.5: Проверка структуры статистики
- **Предусловие**: Создано минимум одно объявление с sellerID = 789012.

- Шаги:

- Отправить GET-запрос на /api/1/789012/item.

- Выбрать первое объявление из списка.

- Проверить объект statistics.

- **Ожидаемый результат**:

- Объект statistics содержит поля:

- `likes` (число)

- `viewCount` (число)

- `contacts` (число).

### TC-3.1.6: Проверка наличия непустого списка
- **Предусловие**: Создано минимум одно объявление с sellerID = 789012.

- **Шаги**:

- Отправить GET-запрос на /api/1/789012/item.

- **Ожидаемый результат**:

- Ответ содержит непустой массив объявлений.
 ---

### 3.2. Негативные тесты
#### TC-3.2.1: Запрос объявлений для несуществующего sellerID
- **Предусловие**: 
  - SellerID находится вне допустимого диапазона (111111-999999) или гарантированно отсутствует в системе.
- **Шаги**:
  1. Отправить GET-запрос на `/api/1/{sellerID}/item`.
- **Ожидаемый результат**:
  - **Если сервер возвращает 200**:
    - Ответ содержит пустой массив `[]`.
  - **Если сервер возвращает 404**:
    - В ответе есть поле `message` с описанием ошибки.

### TC-3.2.2. Попытка получения объявлений с некорректным форматом sellerID
- **Предусловие**: Нет.
- **Шаги**:
  1. Отправить GET-запрос на `/api/1/{sellerID}/item`, где `sellerID` — некорректный формат (например, строка).
  2. Проверить статус ответа.
  3. Проверить, что в ответе есть сообщение об ошибке.
- **Ожидаемый результат**:
  - Статус ответа: `400 Bad Request`.
  - В ответе есть сообщение об ошибке.

---

## 4. Получение статистики по объявлению (GET /api/1/statistic/{id})

### 4.1. Позитивные тесты
### TC-4.1.1: Успешное получение статистики
- **Предусловие**: Объявление с указанным `id` существует.
- **Шаги**:
  1. Отправить GET-запрос на `/api/1/statistic/{id}`, где `id` — идентификатор существующего объявления.
  2. Проверить статус ответа.
  3. Проверить, что в ответе есть поля `likes`, `viewCount`, `contacts`.
- **Ожидаемый результат**:
  - Статус ответа: `200 OK`.
  - В ответе есть поля `likes`, `viewCount`, `contacts`.

### 4.2. Негативные тесты
### TC-4.2.1: Попытка получения статистики для несуществующего объявления (формат id - не UUID)
- **Предусловие**: Объявление с указанным `id` не существует.
- **Шаги**:
  1. Отправить GET-запрос на `/api/1/statistic/{id}`, где `id` — несуществующий идентификатор.
  2. Проверить статус ответа.
  3. Проверить, что в ответе есть сообщение об ошибке.
- **Ожидаемый результат**:
  - Статус ответа: `404 Not Found`.
  - В ответе есть сообщение об ошибке.

#### TC-4.2.2: Статистика для несуществующего объявления (формат UUID)
- **Предусловие**: 
  - Сгенерирован валидный UUID, не связанный с существующими объявлениями.
- **Шаги**:
  1. Отправить GET-запрос на `/api/1/statistic/00000000-0000-0000-0000-000000000000`.
- **Ожидаемый результат**:
  - Статус ответа: `404 Not Found`.
  - В ответе есть поле `message` (например, "Объявление не найдено").


---

## Заключение
Все тест-кейсы покрывают основные сценарии работы API. Для выполнения тестов используйте автоматизированные тесты из файла `test_api.py`.